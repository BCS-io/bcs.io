#!/usr/bin/env bash

#
# Test that webservers respond to requests
#

protocol=http
server=''

print_usage() {
  printf "Curl wrapper:\n"
  printf "  d development server \n"
  printf "  l https request \n"
  printf "  h printing this help message\n"
  printf "  p production server\n"
  printf "\n"
  printf "Example dbg_curl -p \n\n"
  printf "Common errors\n"
  printf "curl: (52) Empty reply from server - HTTP request on HTTPS server\n"
}

while getopts 'dhlp' flag; do
  case "${flag}" in
    d) server=development.bcs.io ;;
    h) print_usage
       exit 1 ;;
    l) protocol=https ;;
    p) server=bcs.io ;;
    *) print_usage
       exit 1;;
  esac
done

if (( $OPTIND == 1 )); then
  print_usage
  exit 1
fi

echo "Debug: ${server}"
echo ""

curl "${protocol}://${server}"